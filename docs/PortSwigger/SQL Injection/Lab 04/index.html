<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.6">
<link rel="alternate" type="application/rss+xml" href="/Writeups/blog/rss.xml" title="Writeups | datthinh1801 Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/Writeups/blog/atom.xml" title="Writeups | datthinh1801 Blog Atom Feed"><title data-react-helmet="true">Lab: SQL injection UNION attack, finding a column containing text | Writeups | datthinh1801</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://datthinh1801.github.io/Writeups/docs/PortSwigger/SQL Injection/Lab 04"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Lab: SQL injection UNION attack, finding a column containing text | Writeups | datthinh1801"><meta data-react-helmet="true" name="description" content="Task"><meta data-react-helmet="true" property="og:description" content="Task"><link data-react-helmet="true" rel="shortcut icon" href="/Writeups/img/gh_profile.png"><link data-react-helmet="true" rel="canonical" href="https://datthinh1801.github.io/Writeups/docs/PortSwigger/SQL Injection/Lab 04"><link data-react-helmet="true" rel="alternate" href="https://datthinh1801.github.io/Writeups/docs/PortSwigger/SQL Injection/Lab 04" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://datthinh1801.github.io/Writeups/docs/PortSwigger/SQL Injection/Lab 04" hreflang="x-default"><link rel="stylesheet" href="/Writeups/assets/css/styles.6c7d232f.css">
<link rel="preload" href="/Writeups/assets/js/runtime~main.3667c77a.js" as="script">
<link rel="preload" href="/Writeups/assets/js/main.e4ea18af.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/Writeups/"><img src="/Writeups/img/gh_profile.png" alt="My Site Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/Writeups/img/gh_profile.png" alt="My Site Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">datthinh1801</b></a><a class="navbar__item navbar__link navbar__link--active" href="/Writeups/docs/intro">Writeups</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/datthinh1801/Writeups" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="react-toggle toggle_3Zt9 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button class="clean-btn backToTopButton_35hR" type="button"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/Writeups/docs/intro">Introduction</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">CSAW Qualification 2021</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">CTFlearn</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Network Security Lab</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">OWASP 10 Juice-Shop</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">OverTheWire</a></li><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">PortSwigger</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Authentication</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Directory Traversal</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Information Disclosure</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">OS Command Injection</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/Writeups/docs/PortSwigger/README">Topics</a></li><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#" tabindex="0">SQL Injection</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/Writeups/docs/PortSwigger/SQL Injection/Lab 01">Lab: SQL injection vulnerability in WHERE clause allowing retrieval of hidden data</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/Writeups/docs/PortSwigger/SQL Injection/Lab 02">Lab: SQL injection vulnerability allowing login bypass</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/Writeups/docs/PortSwigger/SQL Injection/Lab 03">Lab: SQL injection UNION attack, determining the number of columns returned by the query</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/Writeups/docs/PortSwigger/SQL Injection/Lab 04">Lab: SQL injection UNION attack, finding a column containing text</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/Writeups/docs/PortSwigger/SQL Injection/Lab 05">Lab: SQL injection UNION attack, retrieving data from other tables</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/Writeups/docs/PortSwigger/SQL Injection/Lab 06">Lab: SQL injection UNION attack, retrieving multiple values in a single column</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/Writeups/docs/PortSwigger/SQL Injection/Lab 07">Lab: SQL injection attack, querying the database type and version on Oracle</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/Writeups/docs/PortSwigger/SQL Injection/Lab 08">Lab: SQL injection attack, querying the database type and version on MySQL and Microsoft</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/Writeups/docs/PortSwigger/SQL Injection/Lab 09">Lab: SQL injection attack, listing the database contents on non-Oracle databases</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/Writeups/docs/PortSwigger/SQL Injection/Lab 10">Lab: SQL injection attack, listing the database contents on Oracle</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/Writeups/docs/PortSwigger/SQL Injection/Lab 11">Lab: Blind SQL injection with conditional responses</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/Writeups/docs/PortSwigger/SQL Injection/Lab 12">Lab: Blind SQL injection with conditional errors</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/Writeups/docs/PortSwigger/SQL Injection/Lab 13">Lab: Blind SQL injection with time delays</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/Writeups/docs/PortSwigger/SQL Injection/Lab 14">Lab: Blind SQL injection with time delays and information retrieval</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/Writeups/docs/PortSwigger/SQL Injection/Lab 15">Lab: Blind SQL injection with out-of-band interaction</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/Writeups/docs/PortSwigger/SQL Injection/Lab 16">Lab: Blind SQL injection with out-of-band data exfiltration</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/Writeups/docs/PortSwigger/SQL Injection/README">SQL Injection</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">UIUCTF 2021</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">websec.fr</a></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="tocCollapsible_1PrD theme-doc-toc-mobile tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Lab: SQL injection UNION attack, finding a column containing text</h1></header><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="task"></a>Task<a class="hash-link" href="#task" title="Direct link to heading">#</a></h2><p>This lab contains an SQL injection vulnerability in the product category filter. The results from the query are returned in the application&#x27;s response, so you can use a UNION attack to retrieve data from other tables. To construct such an attack, you first need to determine the number of columns returned by the query. You can do this using a technique you learned in a <a href="https://github.com/datthinh1801/Writeups/blob/main/PortSwigger/SQL%20Injection/Lab%2003.md" target="_blank" rel="noopener noreferrer">previous lab</a>. The next step is to identify a column that is compatible with string data.</p><p>The lab will provide a random value that you need to make appear within the query results. To solve the lab, perform an SQL injection UNION attack that returns an additional row containing the value provided. This technique helps you determine which columns are compatible with string data.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="solution"></a>Solution<a class="hash-link" href="#solution" title="Direct link to heading">#</a></h2><p>As stated in the task statement, we need to find the number of columns returned in the response and find a string-compatible column to inject the given string.  </p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="know-the-string-to-inject"></a>Know the string to inject<a class="hash-link" href="#know-the-string-to-inject" title="Direct link to heading">#</a></h3><p>The given string is: <code>fPzEe9</code><br>
<img src="https://user-images.githubusercontent.com/44528004/130059606-97ed7120-652b-4c0b-91a8-fa77c5f2beff.png" alt="image">  </p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="figure-out-the-number-columns"></a>Figure out the number columns<a class="hash-link" href="#figure-out-the-number-columns" title="Direct link to heading">#</a></h3><p>I started with <code>ORDER BY 3--</code>:<br>
<img src="https://user-images.githubusercontent.com/44528004/130059918-250df366-771a-477b-bfea-c2b2a68d307f.png" alt="image">  </p><blockquote><p>No error.  </p></blockquote><p><code>ORDER BY 4--</code>:<br>
<img src="https://user-images.githubusercontent.com/44528004/130059929-92d48e5f-6962-45f5-8f35-675085784fdf.png" alt="image">  </p><blockquote><p>Internal Server Error!  </p></blockquote><p>So the number of columns is <strong>3</strong>.  </p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="find-a-string-compatible-column"></a>Find a string-compatible column<a class="hash-link" href="#find-a-string-compatible-column" title="Direct link to heading">#</a></h3><p>Test the first column:<br>
<img src="https://user-images.githubusercontent.com/44528004/130060191-177da1c2-1ec8-4523-a43d-2fc9a02027d2.png" alt="image">  </p><blockquote><p>Internal Server Error =&gt; The first column is not compatible with type string.  </p></blockquote><p>Test the second column:<br>
<img src="https://user-images.githubusercontent.com/44528004/130060310-2269db1d-e502-4e00-a212-a74cd3823d53.png" alt="image">  </p><blockquote><p>No error =&gt; This columns is string-compatible.  </p></blockquote><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="inject-the-random-string"></a>Inject the random string<a class="hash-link" href="#inject-the-random-string" title="Direct link to heading">#</a></h3><p><img src="https://user-images.githubusercontent.com/44528004/130060375-3eaf4a0b-3d59-49d0-8428-f8ed0eb530ed.png" alt="image"></p><p><img src="https://user-images.githubusercontent.com/44528004/130060397-2bbd6928-68fb-494f-9616-5ef9d054d552.png" alt="image">  </p><blockquote><p>Solved!</p></blockquote></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/datthinh1801/Writupes/tree/main/website/docs/PortSwigger/SQL Injection/Lab 04.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_13-_"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/Writeups/docs/PortSwigger/SQL Injection/Lab 03"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Lab: SQL injection UNION attack, determining the number of columns returned by the query</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/Writeups/docs/PortSwigger/SQL Injection/Lab 05"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Lab: SQL injection UNION attack, retrieving data from other tables Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#task" class="table-of-contents__link">Task</a></li><li><a href="#solution" class="table-of-contents__link">Solution</a><ul><li><a href="#know-the-string-to-inject" class="table-of-contents__link">Know the string to inject</a></li><li><a href="#figure-out-the-number-columns" class="table-of-contents__link">Figure out the number columns</a></li><li><a href="#find-a-string-compatible-column" class="table-of-contents__link">Find a string-compatible column</a></li><li><a href="#inject-the-random-string" class="table-of-contents__link">Inject the random string</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021 datthinh1801. Built with Docusaurus.</div></div></div></footer></div>
<script src="/Writeups/assets/js/runtime~main.3667c77a.js"></script>
<script src="/Writeups/assets/js/main.e4ea18af.js"></script>
</body>
</html>