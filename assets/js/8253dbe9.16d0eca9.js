"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[1849],{3905:function(e,t,n){n.d(t,{Zo:function(){return s},kt:function(){return d}});var r=n(7294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var u=r.createContext({}),l=function(e){var t=r.useContext(u),n=t;return e&&(n="function"==typeof e?e(t):a(a({},t),e)),n},s=function(e){var t=l(e.components);return r.createElement(u.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},m=r.forwardRef((function(e,t){var n=e.components,i=e.mdxType,o=e.originalType,u=e.parentName,s=c(e,["components","mdxType","originalType","parentName"]),m=l(n),d=i,g=m["".concat(u,".").concat(d)]||m[d]||p[d]||o;return n?r.createElement(g,a(a({ref:t},s),{},{components:n})):r.createElement(g,a({ref:t},s))}));function d(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var o=n.length,a=new Array(o);a[0]=m;var c={};for(var u in t)hasOwnProperty.call(t,u)&&(c[u]=t[u]);c.originalType=e,c.mdxType="string"==typeof e?e:i,a[1]=c;for(var l=2;l<o;l++)a[l]=n[l];return r.createElement.apply(null,a)}return r.createElement.apply(null,n)}m.displayName="MDXCreateElement"},6649:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return c},contentTitle:function(){return u},metadata:function(){return l},toc:function(){return s},default:function(){return m}});var r=n(7462),i=n(3366),o=(n(7294),n(3905)),a=["components"],c={},u="Lab: SQL injection UNION attack, finding a column containing text",l={unversionedId:"PortSwigger/SQL Injection/Lab 04",id:"PortSwigger/SQL Injection/Lab 04",isDocsHomePage:!1,title:"Lab: SQL injection UNION attack, finding a column containing text",description:"Task",source:"@site/docs/PortSwigger/SQL Injection/Lab 04.md",sourceDirName:"PortSwigger/SQL Injection",slug:"/PortSwigger/SQL Injection/Lab 04",permalink:"/Writeups/docs/PortSwigger/SQL Injection/Lab 04",editUrl:"https://github.com/datthinh1801/Writupes/tree/main/website/docs/PortSwigger/SQL Injection/Lab 04.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Lab: SQL injection UNION attack, determining the number of columns returned by the query",permalink:"/Writeups/docs/PortSwigger/SQL Injection/Lab 03"},next:{title:"Lab: SQL injection UNION attack, retrieving data from other tables",permalink:"/Writeups/docs/PortSwigger/SQL Injection/Lab 05"}},s=[{value:"Task",id:"task",children:[]},{value:"Solution",id:"solution",children:[{value:"Know the string to inject",id:"know-the-string-to-inject",children:[]},{value:"Figure out the number columns",id:"figure-out-the-number-columns",children:[]},{value:"Find a string-compatible column",id:"find-a-string-compatible-column",children:[]},{value:"Inject the random string",id:"inject-the-random-string",children:[]}]}],p={toc:s};function m(e){var t=e.components,n=(0,i.Z)(e,a);return(0,o.kt)("wrapper",(0,r.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"lab-sql-injection-union-attack-finding-a-column-containing-text"},"Lab: SQL injection UNION attack, finding a column containing text"),(0,o.kt)("h2",{id:"task"},"Task"),(0,o.kt)("p",null,"This lab contains an SQL injection vulnerability in the product category filter. The results from the query are returned in the application's response, so you can use a UNION attack to retrieve data from other tables. To construct such an attack, you first need to determine the number of columns returned by the query. You can do this using a technique you learned in a ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/datthinh1801/Writeups/blob/main/PortSwigger/SQL%20Injection/Lab%2003.md"},"previous lab"),". The next step is to identify a column that is compatible with string data."),(0,o.kt)("p",null,"The lab will provide a random value that you need to make appear within the query results. To solve the lab, perform an SQL injection UNION attack that returns an additional row containing the value provided. This technique helps you determine which columns are compatible with string data."),(0,o.kt)("h2",{id:"solution"},"Solution"),(0,o.kt)("p",null,"As stated in the task statement, we need to find the number of columns returned in the response and find a string-compatible column to inject the given string.  "),(0,o.kt)("h3",{id:"know-the-string-to-inject"},"Know the string to inject"),(0,o.kt)("p",null,"The given string is: ",(0,o.kt)("inlineCode",{parentName:"p"},"fPzEe9"),(0,o.kt)("br",{parentName:"p"}),"\n",(0,o.kt)("img",{parentName:"p",src:"https://user-images.githubusercontent.com/44528004/130059606-97ed7120-652b-4c0b-91a8-fa77c5f2beff.png",alt:"image"}),"  "),(0,o.kt)("h3",{id:"figure-out-the-number-columns"},"Figure out the number columns"),(0,o.kt)("p",null,"I started with ",(0,o.kt)("inlineCode",{parentName:"p"},"ORDER BY 3--"),":",(0,o.kt)("br",{parentName:"p"}),"\n",(0,o.kt)("img",{parentName:"p",src:"https://user-images.githubusercontent.com/44528004/130059918-250df366-771a-477b-bfea-c2b2a68d307f.png",alt:"image"}),"  "),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"No error.  ")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"ORDER BY 4--"),":",(0,o.kt)("br",{parentName:"p"}),"\n",(0,o.kt)("img",{parentName:"p",src:"https://user-images.githubusercontent.com/44528004/130059929-92d48e5f-6962-45f5-8f35-675085784fdf.png",alt:"image"}),"  "),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"Internal Server Error!  ")),(0,o.kt)("p",null,"So the number of columns is ",(0,o.kt)("strong",{parentName:"p"},"3"),".  "),(0,o.kt)("h3",{id:"find-a-string-compatible-column"},"Find a string-compatible column"),(0,o.kt)("p",null,"Test the first column:",(0,o.kt)("br",{parentName:"p"}),"\n",(0,o.kt)("img",{parentName:"p",src:"https://user-images.githubusercontent.com/44528004/130060191-177da1c2-1ec8-4523-a43d-2fc9a02027d2.png",alt:"image"}),"  "),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"Internal Server Error => The first column is not compatible with type string.  ")),(0,o.kt)("p",null,"Test the second column:",(0,o.kt)("br",{parentName:"p"}),"\n",(0,o.kt)("img",{parentName:"p",src:"https://user-images.githubusercontent.com/44528004/130060310-2269db1d-e502-4e00-a212-a74cd3823d53.png",alt:"image"}),"  "),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"No error => This columns is string-compatible.  ")),(0,o.kt)("h3",{id:"inject-the-random-string"},"Inject the random string"),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://user-images.githubusercontent.com/44528004/130060375-3eaf4a0b-3d59-49d0-8428-f8ed0eb530ed.png",alt:"image"})),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://user-images.githubusercontent.com/44528004/130060397-2bbd6928-68fb-494f-9616-5ef9d054d552.png",alt:"image"}),"  "),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"Solved!")))}m.isMDXComponent=!0}}]);