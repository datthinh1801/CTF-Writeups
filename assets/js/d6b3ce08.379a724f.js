"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[1005],{3905:function(e,n,t){t.d(n,{Zo:function(){return p},kt:function(){return h}});var r=t(7294);function o(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function i(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function a(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?i(Object(t),!0).forEach((function(n){o(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function s(e,n){if(null==e)return{};var t,r,o=function(e,n){if(null==e)return{};var t,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)t=i[r],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)t=i[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var c=r.createContext({}),l=function(e){var n=r.useContext(c),t=n;return e&&(t="function"==typeof e?e(n):a(a({},n),e)),t},p=function(e){var n=l(e.components);return r.createElement(c.Provider,{value:n},e.children)},u={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},d=r.forwardRef((function(e,n){var t=e.components,o=e.mdxType,i=e.originalType,c=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),d=l(t),h=o,m=d["".concat(c,".").concat(h)]||d[h]||u[h]||i;return t?r.createElement(m,a(a({ref:n},p),{},{components:t})):r.createElement(m,a({ref:n},p))}));function h(e,n){var t=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var i=t.length,a=new Array(i);a[0]=d;var s={};for(var c in n)hasOwnProperty.call(n,c)&&(s[c]=n[c]);s.originalType=e,s.mdxType="string"==typeof e?e:o,a[1]=s;for(var l=2;l<i;l++)a[l]=t[l];return r.createElement.apply(null,a)}return r.createElement.apply(null,t)}d.displayName="MDXCreateElement"},8793:function(e,n,t){t.r(n),t.d(n,{frontMatter:function(){return s},contentTitle:function(){return c},metadata:function(){return l},toc:function(){return p},default:function(){return d}});var r=t(7462),o=t(3366),i=(t(7294),t(3905)),a=["components"],s={},c=void 0,l={unversionedId:"OverTheWire/Bandit/Level16-Level17",id:"OverTheWire/Bandit/Level16-Level17",isDocsHomePage:!1,title:"Level16-Level17",description:"Goal",source:"@site/docs/OverTheWire/Bandit/Level16-Level17.md",sourceDirName:"OverTheWire/Bandit",slug:"/OverTheWire/Bandit/Level16-Level17",permalink:"/Writeups/docs/OverTheWire/Bandit/Level16-Level17",editUrl:"https://github.com/datthinh1801/Writupes/tree/main/website/docs/OverTheWire/Bandit/Level16-Level17.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Level15-Level16",permalink:"/Writeups/docs/OverTheWire/Bandit/Level15-Level16"},next:{title:"Level17-Level18",permalink:"/Writeups/docs/OverTheWire/Bandit/Level17-Level18"}},p=[{value:"Goal",id:"goal",children:[]},{value:"Solution",id:"solution",children:[]}],u={toc:p};function d(e){var n=e.components,t=(0,o.Z)(e,a);return(0,i.kt)("wrapper",(0,r.Z)({},u,t,{components:n,mdxType:"MDXLayout"}),(0,i.kt)("h2",{id:"goal"},"Goal"),(0,i.kt)("p",null,"The credentials for the next level can be retrieved by submitting the password of the current level to a port on localhost in the range ",(0,i.kt)("strong",{parentName:"p"},"31000")," to ",(0,i.kt)("strong",{parentName:"p"},"32000"),". First find out which of these ports have a server listening on them. Then find out which of those speak SSL and which don\u2019t. There is ",(0,i.kt)("strong",{parentName:"p"},"only 1 server")," that will give the next credentials, the others will simply send back to you whatever you send to it."),(0,i.kt)("h2",{id:"solution"},"Solution"),(0,i.kt)("p",null,"As we need to know a specific port number to connect, we can use ",(0,i.kt)("inlineCode",{parentName:"p"},"nmap")," command to scan for open ports.  "),(0,i.kt)("p",null,"From its manual, we can see that the ",(0,i.kt)("inlineCode",{parentName:"p"},"-p")," to specify port ranges:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"PORT SPECIFICATION AND SCAN ORDER:\n  -p <port ranges>: Only scan specified ports\n")),(0,i.kt)("p",null,"Also, we are only interested in SSL service that does not echo. From the manual, we can use the ",(0,i.kt)("inlineCode",{parentName:"p"},"-sV")," option to determine the services."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"SERVICE/VERSION DETECTION:\n  -sV: Probe open ports to determine service/version info\n")),(0,i.kt)("p",null,"Our final command is:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},'bandit16@bandit:~$ nmap localhost -p 31000-32000 -sV\n\nStarting Nmap 7.40 ( https://nmap.org ) at 2021-09-24 11:37 CEST\nNmap scan report for localhost (127.0.0.1)\nHost is up (0.00023s latency).\nNot shown: 996 closed ports\nPORT      STATE SERVICE     VERSION\n31046/tcp open  echo\n31518/tcp open  ssl/echo\n31691/tcp open  echo\n31790/tcp open  ssl/unknown\n31960/tcp open  echo\n1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :\nSF-Port31790-TCP:V=7.40%T=SSL%I=7%D=9/24%Time=614D9C58%P=x86_64-pc-linux-g\nSF:nu%r(GenericLines,31,"Wrong!\\x20Please\\x20enter\\x20the\\x20correct\\x20cu\nSF:rrent\\x20password\\n")%r(GetRequest,31,"Wrong!\\x20Please\\x20enter\\x20the\nSF:\\x20correct\\x20current\\x20password\\n")%r(HTTPOptions,31,"Wrong!\\x20Plea\nSF:se\\x20enter\\x20the\\x20correct\\x20current\\x20password\\n")%r(RTSPRequest,\nSF:31,"Wrong!\\x20Please\\x20enter\\x20the\\x20correct\\x20current\\x20password\\\nSF:n")%r(Help,31,"Wrong!\\x20Please\\x20enter\\x20the\\x20correct\\x20current\\x\nSF:20password\\n")%r(SSLSessionReq,31,"Wrong!\\x20Please\\x20enter\\x20the\\x20\nSF:correct\\x20current\\x20password\\n")%r(TLSSessionReq,31,"Wrong!\\x20Please\nSF:\\x20enter\\x20the\\x20correct\\x20current\\x20password\\n")%r(Kerberos,31,"W\nSF:rong!\\x20Please\\x20enter\\x20the\\x20correct\\x20current\\x20password\\n")%r\nSF:(FourOhFourRequest,31,"Wrong!\\x20Please\\x20enter\\x20the\\x20correct\\x20c\nSF:urrent\\x20password\\n")%r(LPDString,31,"Wrong!\\x20Please\\x20enter\\x20the\nSF:\\x20correct\\x20current\\x20password\\n")%r(LDAPSearchReq,31,"Wrong!\\x20Pl\nSF:ease\\x20enter\\x20the\\x20correct\\x20current\\x20password\\n")%r(SIPOptions\nSF:,31,"Wrong!\\x20Please\\x20enter\\x20the\\x20correct\\x20current\\x20password\nSF:\\n");\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 89.56 seconds\n')),(0,i.kt)("p",null,"From the outcome, we can see that the ports ",(0,i.kt)("inlineCode",{parentName:"p"},"31518")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"31790")," are SSL service; however, the former performs ",(0,i.kt)("inlineCode",{parentName:"p"},"echo")," service so let's go with the second port."),(0,i.kt)("p",null,"Let's connect to the second port with a SSL connection."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},'bandit16@bandit:~$ openssl s_client -connect localhost:31790 -ign_eof\nCONNECTED(00000003)\ndepth=0 CN = localhost\nverify error:num=18:self signed certificate\nverify return:1\ndepth=0 CN = localhost\nverify return:1\n---\nCertificate chain\n 0 s:/CN=localhost\n   i:/CN=localhost\n---\nServer certificate\n-----BEGIN CERTIFICATE-----\nMIICBjCCAW+gAwIBAgIEatsK7TANBgkqhkiG9w0BAQUFADAUMRIwEAYDVQQDDAls\nb2NhbGhvc3QwHhcNMjEwODA1MjEyMzAxWhcNMjIwODA1MjEyMzAxWjAUMRIwEAYD\nVQQDDAlsb2NhbGhvc3QwgZ8wDQYJKoZIhvcNAQEBBQADgY0AMIGJAoGBALbshxNY\nmdJ/7RpASCHk+XULoBymcRoKY9tPU25zhhPmrFAyv0HNXG/GqPjOxI4MHG627HOf\nb00a/ikeDUTVdCiDXhungyUx6W07H3uiHHbfNLs1QGl2GPdBVA+z5DZcNsWJ1QB5\n888HEzp8YNWyeHnP+5gy5LqlX5hUkF1eu6C1AgMBAAGjZTBjMBQGA1UdEQQNMAuC\nCWxvY2FsaG9zdDBLBglghkgBhvhCAQ0EPhY8QXV0b21hdGljYWxseSBnZW5lcmF0\nZWQgYnkgTmNhdC4gU2VlIGh0dHBzOi8vbm1hcC5vcmcvbmNhdC8uMA0GCSqGSIb3\nDQEBBQUAA4GBABVCD/dhWpgN9KC5Eb6hd9ToreRhof44OQaHalJtsayPBBMTK3Lp\nKC88rNVJW+cX0z+eUe6en0RIvU56dLNT+zm9cbDvCV1cumz4++nauWes/11eA5aG\n2NNgKQHYvT+bOfo3lhOQNwtzpO4MX1sGMjO4dlS4AmxTdjz0UVUPLamk\n-----END CERTIFICATE-----\nsubject=/CN=localhost\nissuer=/CN=localhost\n---\nNo client certificate CA names sent\nPeer signing digest: SHA512\nServer Temp Key: X25519, 253 bits\n---\nSSL handshake has read 1019 bytes and written 269 bytes\nVerification error: self signed certificate\n---\nNew, TLSv1.2, Cipher is ECDHE-RSA-AES256-GCM-SHA384\nServer public key is 1024 bit\nSecure Renegotiation IS supported\nCompression: NONE\nExpansion: NONE\nNo ALPN negotiated\nSSL-Session:\n    Protocol  : TLSv1.2\n    Cipher    : ECDHE-RSA-AES256-GCM-SHA384\n    Session-ID: 6065E530420798856D9056C3C38AD3E7185BA1379C27AEE5C44ED8D8726D15BF\n    Session-ID-ctx: \n    Master-Key: D7C0160F0DD3CF2031AC384203646AAAA2C1CB50A4399812938B7F2E0D327D0490C020D7B2935C1B54E93DE7A7C37146\n    PSK identity: None\n    PSK identity hint: None\n    SRP username: None\n    TLS session ticket lifetime hint: 7200 (seconds)\n    TLS session ticket:\n    0000 - 30 d5 a9 3d 7d a2 f1 16-f5 b3 32 79 c1 92 42 1a   0..=}.....2y..B.\n    0010 - 8a 24 59 ce 39 3c e6 73-64 0e 90 5f f1 aa 50 a0   .$Y.9<.sd.._..P.\n    0020 - 24 7c b3 b0 02 03 f3 52-29 2c 40 95 ef 22 60 c2   $|.....R),@.."`.\n    0030 - a7 96 c8 fe 77 c1 e8 d5-8c 64 ab 95 53 1a bd f2   ....w....d..S...\n    0040 - 16 4b 1f f3 ac 5c 61 d1-05 f1 82 6f 99 52 8a a4   .K...\\a....o.R..\n    0050 - 59 af 89 0a 7b 4e d6 ff-24 94 a9 c2 82 43 cd 1d   Y...{N..$....C..\n    0060 - a6 10 08 ac 53 b2 d8 9d-bb fa 19 17 f2 fa bc d2   ....S...........\n    0070 - a4 30 56 f4 cf 24 39 02-75 6d 89 3d 9a ae 95 92   .0V..$9.um.=....\n    0080 - 8b 0a 98 8c 5c 79 a8 52-c8 53 1b 11 b4 8d 9b 19   ....\\y.R.S......\n    0090 - c2 e7 7c bb 24 8a 40 55-fc 64 02 e2 56 6e ac 32   ..|.$.@U.d..Vn.2\n\n    Start Time: 1632476370\n    Timeout   : 7200 (sec)\n    Verify return code: 18 (self signed certificate)\n    Extended master secret: yes\n---\n')),(0,i.kt)("p",null,"Then submit the current password:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"cluFn7wTiGryunymYOu4RcffSxQluehd\nCorrect!\n-----BEGIN RSA PRIVATE KEY-----\nMIIEogIBAAKCAQEAvmOkuifmMg6HL2YPIOjon6iWfbp7c3jx34YkYWqUH57SUdyJ\nimZzeyGC0gtZPGujUSxiJSWI/oTqexh+cAMTSMlOJf7+BrJObArnxd9Y7YT2bRPQ\nJa6Lzb558YW3FZl87ORiO+rW4LCDCNd2lUvLE/GL2GWyuKN0K5iCd5TbtJzEkQTu\nDSt2mcNn4rhAL+JFr56o4T6z8WWAW18BR6yGrMq7Q/kALHYW3OekePQAzL0VUYbW\nJGTi65CxbCnzc/w4+mqQyvmzpWtMAzJTzAzQxNbkR2MBGySxDLrjg0LWN6sK7wNX\nx0YVztz/zbIkPjfkU1jHS+9EbVNj+D1XFOJuaQIDAQABAoIBABagpxpM1aoLWfvD\nKHcj10nqcoBc4oE11aFYQwik7xfW+24pRNuDE6SFthOar69jp5RlLwD1NhPx3iBl\nJ9nOM8OJ0VToum43UOS8YxF8WwhXriYGnc1sskbwpXOUDc9uX4+UESzH22P29ovd\nd8WErY0gPxun8pbJLmxkAtWNhpMvfe0050vk9TL5wqbu9AlbssgTcCXkMQnPw9nC\nYNN6DDP2lbcBrvgT9YCNL6C+ZKufD52yOQ9qOkwFTEQpjtF4uNtJom+asvlpmS8A\nvLY9r60wYSvmZhNqBUrj7lyCtXMIu1kkd4w7F77k+DjHoAXyxcUp1DGL51sOmama\n+TOWWgECgYEA8JtPxP0GRJ+IQkX262jM3dEIkza8ky5moIwUqYdsx0NxHgRRhORT\n8c8hAuRBb2G82so8vUHk/fur85OEfc9TncnCY2crpoqsghifKLxrLgtT+qDpfZnx\nSatLdt8GfQ85yA7hnWWJ2MxF3NaeSDm75Lsm+tBbAiyc9P2jGRNtMSkCgYEAypHd\nHCctNi/FwjulhttFx/rHYKhLidZDFYeiE/v45bN4yFm8x7R/b0iE7KaszX+Exdvt\nSghaTdcG0Knyw1bpJVyusavPzpaJMjdJ6tcFhVAbAjm7enCIvGCSx+X3l5SiWg0A\nR57hJglezIiVjv3aGwHwvlZvtszK6zV6oXFAu0ECgYAbjo46T4hyP5tJi93V5HDi\nTtiek7xRVxUl+iU7rWkGAXFpMLFteQEsRr7PJ/lemmEY5eTDAFMLy9FL2m9oQWCg\nR8VdwSk8r9FGLS+9aKcV5PI/WEKlwgXinB3OhYimtiG2Cg5JCqIZFHxD6MjEGOiu\nL8ktHMPvodBwNsSBULpG0QKBgBAplTfC1HOnWiMGOU3KPwYWt0O6CdTkmJOmL8Ni\nblh9elyZ9FsGxsgtRBXRsqXuz7wtsQAgLHxbdLq/ZJQ7YfzOKU4ZxEnabvXnvWkU\nYOdjHdSOoKvDQNWu6ucyLRAWFuISeXw9a/9p7ftpxm0TSgyvmfLF2MIAEwyzRqaM\n77pBAoGAMmjmIJdjp+Ez8duyn3ieo36yrttF5NSsJLAbxFpdlc1gvtGCWW+9Cq0b\ndxviW8+TFVEBl1O4f7HVm6EpTscdDxU+bCXWkfjuRb7Dy9GOtt9JPsX8MBTakzh3\nvBgsyi/sN3RqRBcGU40fOoZyfAMT8s1m/uYv52O6IgeuZ/ujbjY=\n-----END RSA PRIVATE KEY-----\n\nclosed\n")),(0,i.kt)("p",null,"This time, our flag is a private RSA key:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"-----BEGIN RSA PRIVATE KEY-----\nMIIEogIBAAKCAQEAvmOkuifmMg6HL2YPIOjon6iWfbp7c3jx34YkYWqUH57SUdyJ\nimZzeyGC0gtZPGujUSxiJSWI/oTqexh+cAMTSMlOJf7+BrJObArnxd9Y7YT2bRPQ\nJa6Lzb558YW3FZl87ORiO+rW4LCDCNd2lUvLE/GL2GWyuKN0K5iCd5TbtJzEkQTu\nDSt2mcNn4rhAL+JFr56o4T6z8WWAW18BR6yGrMq7Q/kALHYW3OekePQAzL0VUYbW\nJGTi65CxbCnzc/w4+mqQyvmzpWtMAzJTzAzQxNbkR2MBGySxDLrjg0LWN6sK7wNX\nx0YVztz/zbIkPjfkU1jHS+9EbVNj+D1XFOJuaQIDAQABAoIBABagpxpM1aoLWfvD\nKHcj10nqcoBc4oE11aFYQwik7xfW+24pRNuDE6SFthOar69jp5RlLwD1NhPx3iBl\nJ9nOM8OJ0VToum43UOS8YxF8WwhXriYGnc1sskbwpXOUDc9uX4+UESzH22P29ovd\nd8WErY0gPxun8pbJLmxkAtWNhpMvfe0050vk9TL5wqbu9AlbssgTcCXkMQnPw9nC\nYNN6DDP2lbcBrvgT9YCNL6C+ZKufD52yOQ9qOkwFTEQpjtF4uNtJom+asvlpmS8A\nvLY9r60wYSvmZhNqBUrj7lyCtXMIu1kkd4w7F77k+DjHoAXyxcUp1DGL51sOmama\n+TOWWgECgYEA8JtPxP0GRJ+IQkX262jM3dEIkza8ky5moIwUqYdsx0NxHgRRhORT\n8c8hAuRBb2G82so8vUHk/fur85OEfc9TncnCY2crpoqsghifKLxrLgtT+qDpfZnx\nSatLdt8GfQ85yA7hnWWJ2MxF3NaeSDm75Lsm+tBbAiyc9P2jGRNtMSkCgYEAypHd\nHCctNi/FwjulhttFx/rHYKhLidZDFYeiE/v45bN4yFm8x7R/b0iE7KaszX+Exdvt\nSghaTdcG0Knyw1bpJVyusavPzpaJMjdJ6tcFhVAbAjm7enCIvGCSx+X3l5SiWg0A\nR57hJglezIiVjv3aGwHwvlZvtszK6zV6oXFAu0ECgYAbjo46T4hyP5tJi93V5HDi\nTtiek7xRVxUl+iU7rWkGAXFpMLFteQEsRr7PJ/lemmEY5eTDAFMLy9FL2m9oQWCg\nR8VdwSk8r9FGLS+9aKcV5PI/WEKlwgXinB3OhYimtiG2Cg5JCqIZFHxD6MjEGOiu\nL8ktHMPvodBwNsSBULpG0QKBgBAplTfC1HOnWiMGOU3KPwYWt0O6CdTkmJOmL8Ni\nblh9elyZ9FsGxsgtRBXRsqXuz7wtsQAgLHxbdLq/ZJQ7YfzOKU4ZxEnabvXnvWkU\nYOdjHdSOoKvDQNWu6ucyLRAWFuISeXw9a/9p7ftpxm0TSgyvmfLF2MIAEwyzRqaM\n77pBAoGAMmjmIJdjp+Ez8duyn3ieo36yrttF5NSsJLAbxFpdlc1gvtGCWW+9Cq0b\ndxviW8+TFVEBl1O4f7HVm6EpTscdDxU+bCXWkfjuRb7Dy9GOtt9JPsX8MBTakzh3\nvBgsyi/sN3RqRBcGU40fOoZyfAMT8s1m/uYv52O6IgeuZ/ujbjY=\n-----END RSA PRIVATE KEY-----\n")))}d.isMDXComponent=!0}}]);